<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NEONVERSE | OMNI-ENGINE</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Orbitron', sans-serif; cursor: none; }
        #game-ui { position: fixed; inset: 0; pointer-events: none; z-index: 10; }
        .vignette { position: fixed; inset: 0; background: radial-gradient(circle, transparent 40%, rgba(0,0,0,0.8) 100%); }
        #reticle { position: fixed; width: 30px; height: 30px; border: 1px solid #00f2ff; border-radius: 50%; transform: translate(-50%, -50%); mix-blend-mode: difference; }
        .kill-feed { position: fixed; top: 20px; right: 20px; text-align: right; color: #ff00ff; font-size: 14px; }
    </style>
</head>
<body>

<div class="vignette"></div>
<div id="reticle"></div>
<div id="game-ui">
    <div style="padding: 30px;">
        <h1 style="color: #00f2ff; margin: 0; font-size: 40px; text-shadow: 0 0 20px #00f2ff;">NEONVERSE</h1>
        <p style="color: #ff00ff; letter-spacing: 5px;">HYPER-COMPETITIVE ARENA</p>
    </div>
    <div class="kill-feed" id="logs">ARENA_INITIALIZED...</div>
</div>

<canvas id="omniCanvas"></canvas>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
import { getDatabase, ref, set, onValue, onDisconnect, push, update } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

const firebaseConfig = {
    apiKey: "AIzaSyD9I2tePOBy4OdbFjbAzxAPvvziqvoe0QI",
    authDomain: "neonverse-aars.firebaseapp.com",
    projectId: "neonverse-aars",
    storageBucket: "neonverse-aars.firebasestorage.app",
    databaseURL: "https://neonverse-aars-default-rtdb.firebaseio.com",
    messagingSenderId: "612438599755",
    appId: "1:612438599755:web:43f1c0a553d56c3aa045ce"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const canvas = document.getElementById('omniCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth; canvas.height = window.innerHeight;

let myId = "USR_" + Math.random().toString(36).substr(2, 4).toUpperCase();
let player = { x: 2500, y: 2500, vx: 0, vy: 0, rot: 0, hp: 100, anim: 0 };
let world = { players: {}, particles: [] };

// ðŸŽ¯ Aiming & VFX
window.onmousemove = (e) => {
    document.getElementById('reticle').style.left = e.clientX + 'px';
    document.getElementById('reticle').style.top = e.clientY + 'px';
};

// âš”ï¸ Professional Combat Trigger
window.onmousedown = () => {
    // Screen Shake Logic
    canvas.style.transform = `translate(${Math.random()*10-5}px, ${Math.random()*10-5}px)`;
    setTimeout(() => canvas.style.transform = 'none', 50);
    
    // Hitscan Logic
    Object.keys(world.players).forEach(id => {
        if(id === myId) return;
        let p = world.players[id];
        let d = Math.hypot(p.x - (player.x + (window.innerWidth/2)), p.y - (player.y + (window.innerHeight/2)));
        // (Simplified for demo, usually involves mouse world-space coords)
    });
};

const keys = {};
window.onkeydown = (e) => keys[e.code] = true;
window.onkeyup = (e) => keys[e.code] = false;

function render() {
    // Advanced Physics (Weight & Momentum)
    const accel = keys['ShiftLeft'] ? 2.5 : 1.2;
    const friction = 0.94;
    
    if (keys['KeyW']) player.vy -= accel; if (keys['KeyS']) player.vy += accel;
    if (keys['KeyA']) player.vx -= accel; if (keys['KeyD']) player.vx += accel;

    player.vx *= friction; player.vy *= friction;
    player.x += player.vx; player.y += player.vy;
    player.anim += 0.1; // Animation timer

    set(ref(db, 'arena/players/' + myId), player);

    // DRAWING THE VOID
    ctx.fillStyle = '#020205'; ctx.fillRect(0,0,canvas.width, canvas.height);
    
    ctx.save();
    ctx.translate(canvas.width/2 - player.x, canvas.height/2 - player.y);

    // DRAW THE UNIVERSE GRID
    ctx.strokeStyle = '#00f2ff0a';
    for(let i=0; i<10000; i+=200) {
        ctx.beginPath(); ctx.moveTo(i, 0); ctx.lineTo(i, 10000); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(0, i); ctx.lineTo(10000, i); ctx.stroke();
    }

    onValue(ref(db, 'arena/players'), (s) => world.players = s.val() || {});

    Object.values(world.players).forEach(p => {
        ctx.save();
        ctx.translate(p.x, p.y);
        
        // Dynamic Glow
        ctx.shadowBlur = 30 + Math.sin(player.anim)*10;
        ctx.shadowColor = '#00f2ff';
        ctx.fillStyle = '#00f2ff';
        
        // Animated Character "Breathing"
        const bounce = Math.sin(player.anim) * 5;
        ctx.fillRect(-20, -20 + bounce, 40, 40);
        
        // HP Shield
        ctx.strokeStyle = '#fff'; ctx.lineWidth = 2;
        ctx.strokeRect(-25, -25 + bounce, 50, 50);
        ctx.restore();
    });

    ctx.restore();
    requestAnimationFrame(render);
}

onDisconnect(ref(db, 'arena/players/' + myId)).remove();
render();
</script>
</body>
</html>
