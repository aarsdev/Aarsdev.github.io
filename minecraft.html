<!DOCTYPE html>
<html>
<head>
    <title>NEONVERSE | THE BIOME EXPANSION</title>
    <style>
        body { background: #000; margin: 0; overflow: hidden; font-family: 'Orbitron', sans-serif; }
        #overlay { position: fixed; inset: 0; background: #000; z-index: 1000; display: flex; align-items: center; justify-content: center; flex-direction: column; }
        .biome-notif { position: fixed; top: 100px; width: 100%; text-align: center; font-size: 24px; color: #fff; text-shadow: 0 0 10px #fff; pointer-events: none; opacity: 0; transition: 2s; }
        canvas { filter: saturate(1.5) contrast(1.1); }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap" rel="stylesheet">
</head>
<body>

    <div id="overlay">
        <h1 style="color: #00f2ff; font-size: 60px;">NEONVERSE</h1>
        <button onclick="start()" style="padding: 15px 50px; background: #ff00ff; color: #fff; border: none; cursor: pointer; font-family: 'Orbitron';">ENTER REALM</button>
    </div>

    <div id="biome-text" class="biome-notif">ENTERING: THE VOID</div>
    <canvas id="stage"></canvas>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getDatabase, ref, set, onValue, onDisconnect, push } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

        // Your Config
        const firebaseConfig = {
            apiKey: "AIzaSyD9I2tePOBy4OdbFjbAzxAPvvziqvoe0QI",
            authDomain: "neonverse-aars.firebaseapp.com",
            projectId: "neonverse-aars",
            storageBucket: "neonverse-aars.firebasestorage.app",
            databaseURL: "https://neonverse-aars-default-rtdb.firebaseio.com",
            messagingSenderId: "612438599755",
            appId: "1:612438599755:web:43f1c0a553d56c3aa045ce"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        const canvas = document.getElementById('stage');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let me = { id: 'p_'+Math.floor(Math.random()*1000), x: 5000, y: 5000, angle: 0, scale: 1 };
        let players = {}, particles = [];

        // ðŸ’  STARTING THE WORLD
        window.start = () => {
            document.getElementById('overlay').style.display = 'none';
            requestAnimationFrame(loop);
        };

        // ðŸ’  PARTICLE ENGINE (Atmosphere)
        for(let i=0; i<100; i++) particles.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, s: Math.random()*2 });

        function loop() {
            // Movement with "Sway" Animation
            let moving = false;
            if(keys['KeyW']) { me.y -= 10; me.angle = -0.1; moving = true; }
            if(keys['KeyS']) { me.y += 10; me.angle = 0.1; moving = true; }
            if(keys['KeyA']) { me.x -= 10; me.scale = -1; moving = true; }
            if(keys['KeyD']) { me.x += 10; me.scale = 1; moving = true; }
            if(!moving) me.angle = 0;

            // Biome Check (Dynamic Theme Shift)
            let biome = "THE NEON WASTES";
            let theme = "#00f2ff";
            if(me.x > 6000) { biome = "THE CRIMSON RIFT"; theme = "#ff0055"; }
            if(me.y < 4000) { biome = "CYBER JUNGLE"; theme = "#00ff88"; }

            set(ref(db, 'players/' + me.id), me);

            // DRAWING
            ctx.fillStyle = "#000"; ctx.fillRect(0,0,canvas.width, canvas.height);
            
            ctx.save();
            ctx.translate(canvas.width/2 - me.x, canvas.height/2 - me.y);

            // Draw Atmospheric Particles
            particles.forEach(p => {
                ctx.fillStyle = theme;
                ctx.fillRect(me.x - canvas.width/2 + p.x, me.y - canvas.height/2 + p.y, p.s, p.s);
            });

            // Draw World Grid
            ctx.strokeStyle = theme + "33"; 
            for(let i=0; i<10000; i+=200) {
                ctx.strokeRect(i, 0, 200, 10000);
            }

            // Draw Players with "Squash & Stretch"
            onValue(ref(db, 'players'), (s) => players = s.val() || {});
            Object.values(players).forEach(p => {
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.angle);
                ctx.scale(p.scale, 1);
                
                // Neon Character Glow
                ctx.shadowBlur = 20; ctx.shadowColor = theme;
                ctx.fillStyle = theme;
                ctx.fillRect(-20, -20, 40, 40);
                
                // Animated Eye
                ctx.fillStyle = "#fff"; ctx.fillRect(5, -10, 5, 5);
                ctx.restore();
            });

            ctx.restore();
            requestAnimationFrame(loop);
        }

        const keys = {};
        window.onkeydown = (e) => keys[e.code] = true;
        window.onkeyup = (e) => keys[e.code] = false;
        onDisconnect(ref(db, 'players/' + me.id)).remove();
    </script>
</body>
</html>
